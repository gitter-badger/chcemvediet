{# vim: set filetype=htmldjango shiftwidth=2 :#}
{% load trans from i18n %}
{% load method with call from poleno.utils %}

{% comment %}
 %
 % Context:
 %  -- name: string
 %  -- textinput: string
 %  -- attachments: [poleno.attachments.models.Attachment]
 %  -- funcs.upload_url: function
 %  -- funcs.download_url: function
 %
{% endcomment %}


<div class="pln-attachments clearfix" data-field="#id_{{name}}">
  {{ textinput }}
  <div class="btn btn-default pln-attachments-btn">
    <span class="glyphicon glyphicon-folder-open"></span> {% trans 'attachments:widget:browse' %}
    <input type="file" name="files" multiple="multiple" data-url="{{ funcs|method:"upload_url"|call }}">
  </div>
  <div class="pln-attachments-skel">
    <div class="pln-attachment" data-attachment="">
      <a href=""></a>
      <button type="button" class="pln-attachment-del">&times;</button>
    </div>
  </div>
  {% for attachment in attachments %}
    <div class="pln-attachment" data-attachment="{{ attachment.pk }}">
      <a href="{{ funcs|method:"download_url"|with:attachment|call }}">{{ attachment.name }}</a>
      <button type="button" class="pln-attachment-del">&times;</button>
    </div>
  {% endfor %}
</div>
